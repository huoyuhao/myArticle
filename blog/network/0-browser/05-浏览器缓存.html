<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端浏览器缓存</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="前端浏览器缓存">
    <meta name="keywords" content="浏览器缓存,缓存,前端缓存,浏览器,">
    <meta name="author" content="liam">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.dff9313a.css" as="style"><link rel="preload" href="/assets/js/app.f6fbab6b.js" as="script"><link rel="preload" href="/assets/js/2.786abe42.js" as="script"><link rel="preload" href="/assets/js/21.80b3605c.js" as="script"><link rel="prefetch" href="/assets/js/10.77e82e09.js"><link rel="prefetch" href="/assets/js/11.a5a6b5ed.js"><link rel="prefetch" href="/assets/js/12.10069527.js"><link rel="prefetch" href="/assets/js/13.8c9afe33.js"><link rel="prefetch" href="/assets/js/14.fbc62396.js"><link rel="prefetch" href="/assets/js/15.991ff191.js"><link rel="prefetch" href="/assets/js/16.d9fc00ae.js"><link rel="prefetch" href="/assets/js/17.105a5b2c.js"><link rel="prefetch" href="/assets/js/18.c8bfb14e.js"><link rel="prefetch" href="/assets/js/19.a64a6747.js"><link rel="prefetch" href="/assets/js/20.1c64489c.js"><link rel="prefetch" href="/assets/js/22.ddc4c9fa.js"><link rel="prefetch" href="/assets/js/23.4cc3f28d.js"><link rel="prefetch" href="/assets/js/24.e6efdc19.js"><link rel="prefetch" href="/assets/js/25.b8254903.js"><link rel="prefetch" href="/assets/js/26.4ec1682c.js"><link rel="prefetch" href="/assets/js/27.26ae01c7.js"><link rel="prefetch" href="/assets/js/28.e49d96e7.js"><link rel="prefetch" href="/assets/js/29.b6301639.js"><link rel="prefetch" href="/assets/js/3.160904e0.js"><link rel="prefetch" href="/assets/js/30.a9e1cdef.js"><link rel="prefetch" href="/assets/js/31.6eceb1c5.js"><link rel="prefetch" href="/assets/js/32.b3ea7de8.js"><link rel="prefetch" href="/assets/js/33.77cbb967.js"><link rel="prefetch" href="/assets/js/34.c7b45509.js"><link rel="prefetch" href="/assets/js/35.837a7ef3.js"><link rel="prefetch" href="/assets/js/36.245c03ed.js"><link rel="prefetch" href="/assets/js/37.22c1fd93.js"><link rel="prefetch" href="/assets/js/38.3bc44b16.js"><link rel="prefetch" href="/assets/js/39.f75493b2.js"><link rel="prefetch" href="/assets/js/4.f82fedd0.js"><link rel="prefetch" href="/assets/js/40.6767b9ec.js"><link rel="prefetch" href="/assets/js/41.4a2ca088.js"><link rel="prefetch" href="/assets/js/42.4d6598da.js"><link rel="prefetch" href="/assets/js/43.3ae578c2.js"><link rel="prefetch" href="/assets/js/44.b8ea32d3.js"><link rel="prefetch" href="/assets/js/45.9aa136df.js"><link rel="prefetch" href="/assets/js/46.809da1e8.js"><link rel="prefetch" href="/assets/js/47.9b3f820a.js"><link rel="prefetch" href="/assets/js/48.bcd666f2.js"><link rel="prefetch" href="/assets/js/49.3d866923.js"><link rel="prefetch" href="/assets/js/5.16b9f8ac.js"><link rel="prefetch" href="/assets/js/50.e42926ef.js"><link rel="prefetch" href="/assets/js/51.a5377ba7.js"><link rel="prefetch" href="/assets/js/52.52e9e1aa.js"><link rel="prefetch" href="/assets/js/53.116e2dd9.js"><link rel="prefetch" href="/assets/js/54.7ed92099.js"><link rel="prefetch" href="/assets/js/55.e41b700c.js"><link rel="prefetch" href="/assets/js/56.8853e7c2.js"><link rel="prefetch" href="/assets/js/57.f0136a02.js"><link rel="prefetch" href="/assets/js/58.be33c188.js"><link rel="prefetch" href="/assets/js/59.f7a5c917.js"><link rel="prefetch" href="/assets/js/6.3c02a0c5.js"><link rel="prefetch" href="/assets/js/60.851642cb.js"><link rel="prefetch" href="/assets/js/61.1885e559.js"><link rel="prefetch" href="/assets/js/62.00eb6270.js"><link rel="prefetch" href="/assets/js/63.35638051.js"><link rel="prefetch" href="/assets/js/64.983d258a.js"><link rel="prefetch" href="/assets/js/65.34d9a389.js"><link rel="prefetch" href="/assets/js/66.b5fa3d17.js"><link rel="prefetch" href="/assets/js/67.2026d719.js"><link rel="prefetch" href="/assets/js/68.689ee670.js"><link rel="prefetch" href="/assets/js/69.ecc29dcf.js"><link rel="prefetch" href="/assets/js/7.86d7dbb1.js"><link rel="prefetch" href="/assets/js/8.f7fbd026.js"><link rel="prefetch" href="/assets/js/9.18f925aa.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dff9313a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/header-logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/frame/" class="nav-link">
  Frame
</a></div><div class="nav-item"><a href="/network/" class="nav-link router-link-active">
  Network
</a></div><div class="nav-item"><a href="/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/other/" class="nav-link">
  Other
</a></div><div class="nav-item"><a href="https://github.com/huoyuhao/myArticle" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/frame/" class="nav-link">
  Frame
</a></div><div class="nav-item"><a href="/network/" class="nav-link router-link-active">
  Network
</a></div><div class="nav-item"><a href="/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/other/" class="nav-link">
  Other
</a></div><div class="nav-item"><a href="https://github.com/huoyuhao/myArticle" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>browser</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/network/0-browser/01-浏览器内核.html" class="sidebar-link">浏览器内核</a></li><li><a href="/network/0-browser/02-浏览器DNS解析.html" class="sidebar-link">浏览器DNS解析</a></li><li><a href="/network/0-browser/03-DNS预解析.html" class="sidebar-link">DNS预解析</a></li><li><a href="/network/0-browser/03-跨域.html" class="sidebar-link">跨域</a></li><li><a href="/network/0-browser/04-Cookie.html" class="sidebar-link">Cookie</a></li><li><a href="/network/0-browser/05-浏览器缓存.html" class="active sidebar-link">浏览器缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#缓存介绍" class="sidebar-link">缓存介绍</a></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#缓存规则" class="sidebar-link">缓存规则</a></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#缓存流程" class="sidebar-link">缓存流程</a></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#强缓存" class="sidebar-link">强缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#_1、强缓存配置" class="sidebar-link">1、强缓存配置</a></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#强缓存响应头" class="sidebar-link">强缓存响应头</a></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#强缓存作用" class="sidebar-link">强缓存作用</a></li></ul></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#协商缓存" class="sidebar-link">协商缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#协商缓存原理" class="sidebar-link">协商缓存原理</a></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#协商缓存作用" class="sidebar-link">协商缓存作用</a></li></ul></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#刷新缓存" class="sidebar-link">刷新缓存</a></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#其他" class="sidebar-link">其他</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#from-disk-cache和from-memory-cache区别" class="sidebar-link">from disk cache和from memory cache区别</a></li><li class="sidebar-sub-header"><a href="/network/0-browser/05-浏览器缓存.html#cache-control的值" class="sidebar-link">Cache-Control的值</a></li></ul></li></ul></li><li><a href="/network/0-browser/06-浏览器渲染.html" class="sidebar-link">浏览器渲染</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>network</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端浏览器缓存"><a href="#前端浏览器缓存" class="header-anchor">#</a> 前端浏览器缓存</h1> <p>浏览器缓存作为性能优化的重要一环，对于前端而言，重要性不言而喻。我想几乎每个开发者都碰到过缓存的问题吧，甚至有很多情况下我们会说这个问题已经修复了，你清理下缓存就好了。这篇文章我们就细细的来挖掘下缓存的种种轶事。</p> <h2 id="缓存介绍"><a href="#缓存介绍" class="header-anchor">#</a> 缓存介绍</h2> <p><strong>缓存是一种保存资源副本并在下次请求时直接使用该副本的技术。</strong></p> <p>很多开发者习惯把cookie、webStorage以及IndexedDB存储的数据也称之为缓存，理由是都是保存在客户端的数据，没有什么区别。其实这是不严谨的，cookie的存在更多的是为了让服务端区别用户，webStorage和IndexedDB则更多用在保存具体的数据和在客户端存储大量结构化数据(文件/blobs)上面。</p> <p>实际上所谓的缓存只有一种——Web缓存。它是指一个Web资源（如html页面，图片，js，数据等）存在于Web服务器和客户端（浏览器）之间的副本。HTTP协议里定义了很多关于缓存的请求和响应字段，这也是接下来我们重点要了解熟悉的对象，研究下究竟是哪些字段怎么影响缓存的。</p> <h2 id="缓存规则"><a href="#缓存规则" class="header-anchor">#</a> 缓存规则</h2> <p>http缓存规则由响应首部字段进行控制，其中的关键字段有<code>Expires、Cache-Control、Last-Modified、Etag</code>四个字段。Expires和Cache-Control用来确定确定缓存的存储时间，Last-Modified 和Etag则用来确定缓存是否要被更新。</p> <table><thead><tr><th>关键字段</th> <th>描述</th></tr></thead> <tbody><tr><td>Expires</td> <td>HTTP1.0中用来控制缓存时间的参数，绝对时间， 即在此时间之后，响应过期。</td></tr> <tr><td>Cache-Control</td> <td>HTTP1.1中用来控制缓存时间的参数，相对时间。</td></tr> <tr><td>Last-Modified</td> <td>源头服务器认定的资源做出修改的日期及时间。</td></tr> <tr><td>Etag</td> <td>HTTP响应头是资源的特定版本的标识符。</td></tr></tbody></table> <h2 id="缓存流程"><a href="#缓存流程" class="header-anchor">#</a> 缓存流程</h2> <p>目前主流的浏览器缓存分为两类，强缓存和协商缓存，它们的匹配流程如下：</p> <ul><li>浏览器发送请求前，根据请求头的expires和cache-control判断是否命中强缓存策略，如果命中，直接从缓存获取资源，并不会发送请求。如果没有命中，则进入下一步。</li> <li>没有命中强缓存规则，浏览器会发送请求，根据请求头的last-modified和etag判断是否命中协商缓存，如果命中，直接从缓存获取资源。如果没有命中，则进入下一步。</li> <li>如果前两步都没有命中，则直接从服务端获取资源。</li></ul> <p><img src="/img/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E5%8E%9F%E7%90%86.png" alt="浏览器缓存原理"></p> <h2 id="强缓存"><a href="#强缓存" class="header-anchor">#</a> 强缓存</h2> <h3 id="_1、强缓存配置"><a href="#_1、强缓存配置" class="header-anchor">#</a> 1、强缓存配置</h3> <p>强缓存可以通过服务端设置expires和cache-control来控制。</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>server <span class="token punctuation">{</span>
  listen <span class="token number">80</span><span class="token punctuation">;</span>
  server_name www<span class="token operator">.</span>liam<span class="token operator">.</span>huoyuhao<span class="token operator">.</span>com<span class="token punctuation">;</span>
  root <span class="token operator">/</span>www<span class="token operator">/</span>liamTest<span class="token operator">/</span><span class="token punctuation">;</span>
  index index<span class="token operator">.</span>html<span class="token punctuation">;</span>
  charset utf<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">;</span>
  location <span class="token operator">~</span> <span class="token operator">.</span><span class="token operator">*</span>\<span class="token operator">.</span><span class="token punctuation">(</span><span class="token class-name">gif</span><span class="token operator">|</span><span class="token class-name">jpg</span><span class="token operator">|</span><span class="token class-name">png</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">.</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    expires <span class="token number">10</span>s<span class="token punctuation">;</span>
    add_header wall <span class="token string double-quoted-string">&quot;hello liam!!!&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="强缓存响应头"><a href="#强缓存响应头" class="header-anchor">#</a> 强缓存响应头</h3> <p><img src="/img/%E5%BC%BA%E7%BC%93%E5%AD%98%E5%93%8D%E5%BA%94%E5%A4%B4%E4%BF%A1%E6%81%AF.png" alt="强缓存响应头信息"></p> <p>（1）expires：从图可以看出，expires的值是一个绝对时间，是<code>http1.0</code>的功能。如果浏览器的时间没有超过这个expires的时间，代表缓存还有效，命中强缓存，直接从缓存读取资源。不过由于存在浏览器和服务端时间可能出现较大误差，所以在之后http1.1提出了cache-control。</p> <p>（2）cache-control：从图可以看出，cache-control的值是类似于max-age=10这样的，是一个相对时间，10是秒数。当浏览器第一次请求资源的时候，会把response header的内容缓存下来。之后的请求会先从缓存检查该response header，通过第一次请求的date和cache-control计算出缓存有效时间。如果浏览器的时间没有超过这个缓存有效的时间，代表缓存还有效，命中强缓存，直接从缓存读取资源。</p> <p><strong>两者可以同时设置，但是优先级cache-control &gt; expires。</strong></p> <h3 id="强缓存作用"><a href="#强缓存作用" class="header-anchor">#</a> 强缓存作用</h3> <p>强缓存作为性能优化中缓存方面最有效的手段，能够极大的提升性能。由于强缓存不会向服务端发送请求，对服务端的压力也是大大减小。对于不太经常变更的资源，可以设置一个超长时间的缓存时间，比如一年。浏览器在首次加载后，都会从缓存中读取。
但是由于不会向服务端发送请求，那么如果资源有更改的时候，怎么让浏览器知道呢？现在常用的解决方法是加一个?v=xxx的后缀，在更新静态资源版本的时候，更新这个v的值，这样相当于向服务端发起一个新的请求，从而达到更新静态资源的目的。（浏览器缓存资源的匹配规则的key是与资源请求URL的全链接相关的，所以更改后缀，浏览器找不到缓存资源）</p> <h2 id="协商缓存"><a href="#协商缓存" class="header-anchor">#</a> 协商缓存</h2> <h3 id="协商缓存原理"><a href="#协商缓存原理" class="header-anchor">#</a> 协商缓存原理</h3> <p>在强缓存没有命中的时候，就是协商缓存发挥的地盘了。协商缓存会根据[last-modified/if-modified-since]或者[etag/if-none-match]来进行判断缓存是否过期。</p> <p><img src="/img/%E5%8D%8F%E5%95%86%E7%BC%93%E5%AD%98%E5%93%8D%E5%BA%94%E5%A4%B4%E4%BF%A1%E6%81%AF.png" alt="协商缓存请求头/响应头信息"></p> <ul><li><p>（1）last-modified/if-modified-since: 浏览器首先发送一个请求，让服务端在response header中返回请求的资源上次更新时间，就是last-modified，浏览器会缓存下这个时间。然后浏览器再下次请求中，request header中带上if-modified-since:[保存的last-modified的值]。根据浏览器发送的修改时间和服务端的修改时间进行比对，一致的话代表资源没有改变，服务端返回正文为空的响应，让浏览器中缓存中读取资源，这就大大减小了请求的消耗。由于last-modified依赖的是保存的绝对时间，还是会出现误差的情况：一是保存的时间是以秒为单位的，1秒内多次修改是无法捕捉到的；二是各机器读取到的时间不一致，就有出现误差的可能性。为了改善这个问题，提出了使用etag。</p></li> <li><p>（2）etag/if-none-match：etag是http协议提供的若干机制中的一种Web缓存验证机制，并且允许客户端进行缓存协商。生成etag常用的方法包括对资源内容使用抗碰撞散列函数，使用最近修改的时间戳的哈希值，甚至只是一个版本号。 和last-modified一样，浏览器会先发送一个请求得到etag的值，然后再下一次请求在request header中带上if-none-match:[保存的etag的值]。通过发送的etag的值和服务端重新生成的etag的值进行比对，如果一致代表资源没有改变，服务端返回正文为空的响应，告诉浏览器从缓存中读取资源。</p></li></ul> <p>etag能够解决last-modified的一些缺点，但是etag每次服务端生成都需要进行读写操作，而last-modified只需要读取操作，从这方面来看，etag的消耗是更大的。</p> <h3 id="协商缓存作用"><a href="#协商缓存作用" class="header-anchor">#</a> 协商缓存作用</h3> <p>协商缓存是无法减少请求数的开销的，但是可以减少返回的正文大小。一般来说，对于勤改动的html文件，使用协商缓存是一种不错的选择。</p> <h2 id="刷新缓存"><a href="#刷新缓存" class="header-anchor">#</a> 刷新缓存</h2> <p>刷新强缓存可以使用?v=xxx的后缀。当然，人工更改版本号的成本比较高，而且难以维护，现在主流的是通过webpack等打包工具生成[name].[hash].js之类的文件名，也能刷新强缓存。</p> <p>刷新协商缓存比较简单，修改文件内容即可。</p> <p>对于浏览器而言，在Chrome中，你可以使用审查元素，高版本也叫检查，将Network中的Disable cache打勾，使用cmd+r刷新页面即可。当然你也可以使用强制刷新，直接在页面使用cmd+shift+r进行刷新。</p> <h2 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h2> <h3 id="from-disk-cache和from-memory-cache区别"><a href="#from-disk-cache和from-memory-cache区别" class="header-anchor">#</a> from disk cache和from memory cache区别</h3> <h4 id="_1-form-memory-cache"><a href="#_1-form-memory-cache" class="header-anchor">#</a> 1）form memory cache</h4> <p>不请求网络资源，资源在内存当中，一般脚本、字体、图片会存在内存当中。浏览器关闭后，数据将不存在（资源被释放掉了），再次打开相同的页面时，不会出现from memory cache。</p> <h4 id="_2-form-disk-cache"><a href="#_2-form-disk-cache" class="header-anchor">#</a> 2）form disk cache</h4> <p>不请求网络资源，在磁盘当中，一般非脚本会存在内存当中，如css等。闭浏览器后，数据依然存在，此资源不会随着该页面的关闭而释放掉下次打开仍然会是from disk cache。</p> <h4 id="_3-几种状态的执行顺序"><a href="#_3-几种状态的执行顺序" class="header-anchor">#</a> 3）几种状态的执行顺序</h4> <p>现加载一种资源（例如：图片）：</p> <p>访问-&gt; 200 -&gt; 退出浏览器</p> <p>再进来-&gt; 200(from disk cache) -&gt; 刷新 -&gt; 200(from memory cache)</p> <h4 id="_4-不同浏览器策略不同"><a href="#_4-不同浏览器策略不同" class="header-anchor">#</a> 4）不同浏览器策略不同</h4> <p>以上的数据及统计都是在chrome浏览器下进行的</p> <p>在Firefox下并没有from memory cache以及from disk cache的状态展现</p> <h3 id="cache-control的值"><a href="#cache-control的值" class="header-anchor">#</a> Cache-Control的值</h3> <p>1）可缓存性</p> <table><thead><tr><th>属性</th> <th>含义</th></tr></thead> <tbody><tr><td><strong>public</strong></td> <td>表明响应可以被任何对象（包括：发送请求的客户端，代理服务器，等等）缓存</td></tr> <tr><td><strong>private</strong></td> <td>表明响应只能被单个用户缓存，不能作为共享缓存（即<strong>代理服务器不能缓存它</strong>），可以缓存响应内容</td></tr> <tr><td><strong>no-cache</strong></td> <td><strong>在释放缓存副本之前，强制高速缓存将请求提交给原始服务器进行验证</strong></td></tr> <tr><td>only-if-cached</td> <td>表明客户端只接受已缓存的响应，并且不要向原始服务器检查是否有更新的拷贝</td></tr></tbody></table> <p>2）到期</p> <table><thead><tr><th>属性</th> <th>含义</th></tr></thead> <tbody><tr><td>max-age = number</td> <td>设置缓存存储的最大周期，超过这个时间缓存被认为过期(单位秒)。与Expires相反，时间是相对于请求的时间。</td></tr> <tr><td>s-maxage = number</td> <td>覆盖max-age 或者 Expires 头，但是仅适用于共享缓存(比如各个代理)，并且私有缓存中它被忽略。</td></tr> <tr><td>max-stale[ = number]</td> <td>表明客户端愿意接收一个已经过期的资源。 可选的设置一个时间(单位秒)，表示响应不能超过的过时时间。</td></tr> <tr><td>min-fresh = number</td> <td>表示客户端希望在指定的时间内获取最新的响应。</td></tr> <tr><td>stale-while-revalidate = number</td> <td>表明客户端愿意接受陈旧的响应，同时在后台异步检查新的响应。秒值指示客户愿意接受陈旧响应的时间长度。</td></tr> <tr><td>stale-if-error = number</td> <td>表示如果新的检查失败，则客户愿意接受陈旧的响应。秒数值表示客户在初始到期后愿意接受陈旧响应的时间。</td></tr></tbody></table> <p>3）其他</p> <table><thead><tr><th>属性</th> <th>含义</th></tr></thead> <tbody><tr><td><strong>no-store</strong></td> <td><strong>缓存不应存储有关客户端请求或服务器响应的任何内容。</strong></td></tr> <tr><td>no-transform</td> <td>不得对资源进行转换或转变。Content-Encoding， Content-Range， Content-Type等HTTP头不能由代理修改。例如，非透明代理可以对图像格式进行转换，以便节省缓存空间或者减少缓慢链路上的流量。 no-transform指令不允许这样做。</td></tr></tbody></table> <p>【参考文章】</p> <p><a href="https://juejin.im/post/5a6c87c46fb9a01ca560b4d7" target="_blank" rel="noopener noreferrer">掘金 -- 缓存详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.im/post/5be3f486e51d45053d5c38ca" target="_blank" rel="noopener noreferrer">http缓存与cdn缓存配置指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://excaliburhan.com/post/things-you-should-know-about-browser-cache.html" target="_blank" rel="noopener noreferrer">你应该知道的浏览器缓存知识<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/5/2022, 10:42:32 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/network/0-browser/04-Cookie.html" class="prev">
        Cookie
      </a></span> <span class="next"><a href="/network/0-browser/06-浏览器渲染.html">
        浏览器渲染
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.f6fbab6b.js" defer></script><script src="/assets/js/2.786abe42.js" defer></script><script src="/assets/js/21.80b3605c.js" defer></script>
  </body>
</html>
