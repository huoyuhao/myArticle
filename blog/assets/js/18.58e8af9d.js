(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{294:function(t,s,a){"use strict";a.r(s);var r=a(10),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"浏览器dns预解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器dns预解析"}},[t._v("#")]),t._v(" 浏览器DNS预解析")]),t._v(" "),s("h2",{attrs:{id:"背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),s("p",[t._v("在前端优化中与 DNS 的有关一般有两点： 一个是减少DNS的请求次数，另一个就是进行DNS预获取 。DNS作为互联网的基础协议，往往容易被网站优化人员忽略。")]),t._v(" "),s("h2",{attrs:{id:"dns与域名解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dns与域名解析"}},[t._v("#")]),t._v(" DNS与域名解析")]),t._v(" "),s("ul",[s("li",[t._v("DNS全称为Domain Name System，即域名系统，是域名和IP地址相互映射的一个分布式数据库。")]),t._v(" "),s("li",[t._v("域名解析即通过主机名，最终得到该主机名对应的IP地址的过程。")]),t._v(" "),s("li",[t._v("浏览器对网站第一次的域名DNS解析查找流程依次为：")]),t._v(" "),s("li",[t._v("浏览器缓存 - 系统缓存 - 路由器缓存 - ISP DNS缓存 - 递归搜索")])]),t._v(" "),s("h2",{attrs:{id:"解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[t._v("#")]),t._v(" 解决方案")]),t._v(" "),s("ul",[s("li",[t._v("DNS预解析是浏览器试图在用户访问链接之前解析域名，这是计算机的正常DNS解析机制。")]),t._v(" "),s("li",[t._v("域名解析后，如果用户确实访问该域名，那么DNS解析时间将不会有延迟。")]),t._v(" "),s("li",[t._v("遇到网页中的超链接，DNS prefetching从中提取域名并将其解析为IP地址，这些工作在用户浏览网页时，使用最少的CPU和网络在后台进行解析。")]),t._v(" "),s("li",[t._v("当用户点击这些已经预解析的域名，可以平均减少200毫秒耗时（假设用户最近还未访问过该域名）。")])]),t._v(" "),s("h2",{attrs:{id:"dns-prefetching简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dns-prefetching简介"}},[t._v("#")]),t._v(" DNS Prefetching简介")]),t._v(" "),s("ul",[s("li",[t._v("DNS请求需要的带宽非常小，但是延迟却有点高，这点在手机网络上特别明显，而一次典型的DNS解析一般需要20-200ms，所以DNS预解析可以让延迟明显减少一些。")]),t._v(" "),s("li",[t._v("在某些浏览器中这个预读取的行为将会与页面实际内容并行发生（而不是串行）。正因如此，某些高延迟的域名的解析过程才不会卡住资源的加载。")]),t._v(" "),s("li",[t._v("这样可以极大的加速（尤其是移动网络环境下）页面的加载。在某些图片较多的页面中，在发起图片加载请求之前预先把域名解析好将会有至少 5% 的图片加载速度提升。")])]),t._v(" "),s("h2",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),s("p",[s("code",[t._v("X-DNS-Prefetch-Control")]),t._v(" 头控制着浏览器的DNS预解析功能")]),t._v(" "),s("p",[s("code",[t._v("X-DNS_prefetch-Control: on|off")])]),t._v(" "),s("ul",[s("li",[t._v("on：启用DNS预解析。在浏览器支持DNS预解析的特性时及时不适用该标签浏览器依然会进行预解析。")]),t._v(" "),s("li",[t._v("off：关闭DNS预解析。这个属性在页面上的链接并不是由你控制的或是你根本不想向这些域名引导数据时非常有用。")])]),t._v(" "),s("h2",{attrs:{id:"浏览器支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器支持"}},[t._v("#")]),t._v(" 浏览器支持")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/dns-prefetch.png",alt:"dns-prefetch.png"}})]),t._v(" "),s("h3",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 打开和关闭DNS预读取")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("meta http"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("equiv"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x-dns-prefetch-control"')]),t._v(" content"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"off"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("meta"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 强制查询特定主机名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("link rel"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dns-prefetch"')]),t._v(" href"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"//hm.baidu.com"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("link"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);